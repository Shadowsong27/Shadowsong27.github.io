<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/shadowsong27.github.io\/",
  "author": {
    "@type": "Person",
    "name":  null ,
    
  },
  "name":"Shadowsong\u0027s Personal Website",
  "description":"\u003cblockquote\u003e\n\u003cp\u003eIn linear algebra, an idempotent matrix is a matrix which, when multiplied by itself, yields itself.\u003c\/p\u003e\u003c\/blockquote\u003e",
  "url":"https:\/\/shadowsong27.github.io\/2019\/08\/de-log-1-idempotency\/",
  "keywords":"[]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.148.0 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="">
<meta name="keywords" content="">
<meta name="description" content="
In linear algebra, an idempotent matrix is a matrix which, when multiplied by itself, yields itself.">


<meta property="og:description" content="
In linear algebra, an idempotent matrix is a matrix which, when multiplied by itself, yields itself.">
<meta property="og:type" content="article">
<meta property="og:title" content="DE Log 1: Idempotency">
<meta name="twitter:title" content="DE Log 1: Idempotency">
<meta property="og:url" content="https://shadowsong27.github.io/2019/08/de-log-1-idempotency/">
<meta property="twitter:url" content="https://shadowsong27.github.io/2019/08/de-log-1-idempotency/">
<meta property="og:site_name" content="Shadowsong&#39;s Personal Website">
<meta property="og:description" content="
In linear algebra, an idempotent matrix is a matrix which, when multiplied by itself, yields itself.">
<meta name="twitter:description" content="
In linear algebra, an idempotent matrix is a matrix which, when multiplied by itself, yields itself.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2019-08-31T00:00:00">
  
  
    <meta property="article:modified_time" content="2019-08-31T00:00:00">
  
  
  
    
      <meta property="article:section" content="data">
    
      <meta property="article:section" content="data-engineering">
    
  
  


<meta name="twitter:card" content="summary">










  <meta property="og:image" content="https://www.mistrasgroup.com/media/1540/steel-pipeline.jpg?center=0.4425,0.49&amp;mode=crop&amp;width=1500&amp;height=600&amp;rnd=131921218510000000">
  <meta property="twitter:image" content="https://www.mistrasgroup.com/media/1540/steel-pipeline.jpg?center=0.4425,0.49&amp;mode=crop&amp;width=1500&amp;height=600&amp;rnd=131921218510000000">


  <meta property="og:image" content="https://www.mistrasgroup.com/media/1540/steel-pipeline.jpg?center=0.4425,0.49&amp;mode=crop&amp;width=1500&amp;height=600&amp;rnd=131921218510000000">
  <meta property="twitter:image" content="https://www.mistrasgroup.com/media/1540/steel-pipeline.jpg?center=0.4425,0.49&amp;mode=crop&amp;width=1500&amp;height=600&amp;rnd=131921218510000000">


    <title>DE Log 1: Idempotency</title>

    <link rel="icon" href="https://shadowsong27.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://shadowsong27.github.io/2019/08/de-log-1-idempotency/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://shadowsong27.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://shadowsong27.github.io/" aria-label="Go to homepage">Shadowsong&#39;s Personal Website</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://shadowsong27.github.io/#about" aria-label="Open the link: /#about">
    
    
    
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://shadowsong27.github.io/" title="Home">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://shadowsong27.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://shadowsong27.github.io/tags" title="Tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://shadowsong27.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://shadowsong27.github.io/career" title="Career">
    
      <i class="sidebar-button-icon fa fa-lg fa-suitcase"></i>
      
      <span class="sidebar-button-desc">Career</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://shadowsong27.github.io/food" title="Food">
    
      <i class="sidebar-button-icon fa fa-cutlery"></i>
      
      <span class="sidebar-button-desc">Food</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/Shadowsong27" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-center
              "
       style="background-image:url('https://www.mistrasgroup.com/media/1540/steel-pipeline.jpg?center=0.4425,0.49&amp;mode=crop&amp;width=1500&amp;height=600&amp;rnd=131921218510000000')"
       data-behavior="5">
    
  </div>


      <div id="main" data-behavior="5"
        class="hasCover
               hasCoverMetaOut
               ">
        <article class="post" id="top">
          
          
            <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title">
      DE Log 1: Idempotency
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2019-08-31T00:00:00Z">
        
  August 31, 2019

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://shadowsong27.github.io/categories/data">data</a>, 
    
      <a class="category-link" href="https://shadowsong27.github.io/categories/data-engineering">data-engineering</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <blockquote>
<p>In linear algebra, an idempotent matrix is a matrix which, when multiplied by itself, yields itself.</p></blockquote>
<h1 id="overview">Overview</h1>
<p>Today I would like to talk about idempotency in Data Engineering.</p>
<p>I first learnt this word in Year 1 Uni, an intro Linear Algebra course (probably my best Maths module ever in the entire uni life).</p>
<p>The term <code>idempotent matrix</code> means:</p>
<blockquote>
<p>In linear algebra, an idempotent matrix is a matrix which, when multiplied by itself, yields itself.</p></blockquote>
<p>Well in data engineering, it most likely means no matter how many times you execute a ETL job,
it will return you the same transformation result, provided the source data is unchanged.</p>
<p>I have known this concept and the benefits of it at the early stage of my career,
but only recently (after working on the Data Warehouse migration to Redshift) I have start to appreciate its importance.</p>
<h3 id="incremental-vs-idempotent">Incremental vs Idempotent</h3>
<p>Before describing the benefits, I would like to define the following two types of ETL jobs:</p>
<ol>
<li>Incremental job, ETL jobs that require incremental changes to a table or data storage, e.g. <code>append</code> or <code>update</code> mode</li>
<li>Idempotent job, or I often call it refresh job for naming convention (easier to spell), it is something that I have explained above.</li>
</ol>
<h1 id="benefits">Benefits</h1>
<p>Basically, when you have an idempotent ETL job:</p>
<h3 id="minimal-maintenance">Minimal maintenance</h3>
<p>No backfill required, no need to worry about discontinuity in data during execution,
and you know exactly what data you are transforming during re-execution.</p>
<p>This is the most important thing, though it might take a longer time in the process
compared to incremental task (not necessarily, and if it is too long it means you should look for
an alternative solution, e.g. move your Python Operator to Spark),
but the cost and trouble saved are much more crucial here.</p>
<p>The cost here could refer to debugging time, data validation and patching time etc.</p>
<h3 id="easier-to-debug">Easier to debug</h3>
<p>It is easier to debug since everything can be refreshed as many times as you like, any time you want as
long as dependencies are fulfilled. Normally data debugging is different from functionality debugging
because the data is often dynamic, and that posts some challenges to even locate the bugs.</p>
<h3 id="less-temporal-dependency">Less temporal dependency</h3>
<p>One of the common incremental jobs is the building of a time series table, e.g DAU MAU computation.
They often require certain level of data quality because they are used frequently in making business decisions.</p>
<p>However, sometimes we have data arrived later than the execution date (it could be a few days late), that
requires you to recompute and update the data if you want a more accurate result or the portion of delayed data
is too significant.</p>
<p>One way to approach is to setup another pipeline to adjust the numbers after the first execution, or
simply delayed the execution by a few days (which is fine because honestly you can&rsquo;t do anything since
you do not have the data in data warehouse yet).</p>
<p>An idempotent job would save you the trouble to maintain two separate pipelines, and the dependencies in between,
it makes sure every newly arrived data are considered during daily transformation.</p>
<h3 id="less-bug-prone">Less bug-prone</h3>
<p>A bit similar to point 2. This means there will not be any confounding
factors contribute to your problematic transformation result, leaving you only the transformation logic to debug.</p>
<p>Otherwise you might think &hellip; hmmmm I remember two days ago some guy just manually updated
a static table, when was it, let me ask him / check logs first (if you do not want to disturb others),
and ahhhhhhhhhhh itâ€™s right before the execution time that&rsquo;s why! I have wasted two hours of my life again &hellip;</p>
<h3 id="works-better-with-modern-data-warehouse">Works better with modern Data Warehouse</h3>
<p>We used to have a lot of update statements, getting only the latest data chunks,
update the necessary columns when we were still using Postgres as our Data Warehouse.
Over time the data quality starts to drop because of accidentally failed ETLs.
It was apparently a trade off between performance and data quality.</p>
<p>After we shift to Redshift, single <code>insert</code> or <code>update</code> start to become costly,
I am forced to rethink and redesign many of our jobs and I am so happy that I eventually got rid of all the <code>update</code> statements.</p>
<h1 id="final-comment">Final comment</h1>
<p>I did not mean we should always do idempotent jobs
(sometimes we will have to use incremental jobs, they are great too but they require much higher maintenance),
we have deadlines, we have legacy codes, it all depends on priorities. If the data quality is slightly off,
it might not have an impact at all. So think twice before actually start to refactoring pipelines.</p>
<p>The ultimate goal is of course, to walk into the office every morning
without worrying about something / somebody is breaking the pipelines again, thank you very much.</p>
              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://shadowsong27.github.io/2019/09/movie-log-3-ad-astra/" data-tooltip="Movie Log 3 - Ad Astra" aria-label="NEXT: Movie Log 3 - Ad Astra">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://shadowsong27.github.io/2019/08/dramas-checklist/" data-tooltip="Dramas Checklist" aria-label="PREVIOUS: Dramas Checklist">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://shadowsong27.github.io/2019/08/de-log-1-idempotency/" title="Share on Facebook" aria-label="Share on Facebook">
          <i class="fa-facebook-official" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://shadowsong27.github.io/2019/08/de-log-1-idempotency/" title="Share on Twitter" aria-label="Share on Twitter">
          <i class="fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://shadowsong27.github.io/2019/08/de-log-1-idempotency/" title="Share on Google&#43;" aria-label="Share on Google&#43;">
          <i class="fa-google-plus" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2025 Shadowsong&#39;s Personal Website. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://shadowsong27.github.io/2019/09/movie-log-3-ad-astra/" data-tooltip="Movie Log 3 - Ad Astra" aria-label="NEXT: Movie Log 3 - Ad Astra">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://shadowsong27.github.io/2019/08/dramas-checklist/" data-tooltip="Dramas Checklist" aria-label="PREVIOUS: Dramas Checklist">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://shadowsong27.github.io/2019/08/de-log-1-idempotency/" title="Share on Facebook" aria-label="Share on Facebook">
          <i class="fa-facebook-official" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://shadowsong27.github.io/2019/08/de-log-1-idempotency/" title="Share on Twitter" aria-label="Share on Twitter">
          <i class="fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://shadowsong27.github.io/2019/08/de-log-1-idempotency/" title="Share on Google&#43;" aria-label="Share on Google&#43;">
          <i class="fa-google-plus" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      
<div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-times"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fshadowsong27.github.io%2F2019%2F08%2Fde-log-1-idempotency%2F" aria-label="Share on Facebook">
          <i class="fa-facebook-official" aria-hidden="true"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fshadowsong27.github.io%2F2019%2F08%2Fde-log-1-idempotency%2F" aria-label="Share on Twitter">
          <i class="fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https%3A%2F%2Fshadowsong27.github.io%2F2019%2F08%2Fde-log-1-idempotency%2F" aria-label="Share on Google&#43;">
          <i class="fa-google-plus" aria-hidden="true"></i><span>Share on Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>


    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
    <h4 id="about-card-name"></h4>
    
    
    
  </div>
</div>

    

    
  
    <div id="cover" style="background-image:url('https://i.pinimg.com/originals/00/93/9d/00939dff0059e823658afe98bb6d87a4.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js" integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://shadowsong27.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>




    
  </body>
</html>

